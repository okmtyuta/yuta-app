---
title: Brief Summary of Confidence sets for persistence diagrams
postedAt: 2024-06-06
slug: '4'
description: None
serie: mathematics
genre: study
tags: [homology, mathematics, TDA]
---

## Basic information

- **Title**: Confidence sets for persistence diagrams
- **Author**: Brittany Terese Fasy, Fabrizio Lecci, Alessandro Rinaldo, Larry Wasserman, Sivaraman Balakrishnan, and Aarti Singh
- **Publication year**: 2014
- **Journal**: The Annals of Statistics
- **URL to access the paper**: https://projecteuclid.org/journals/annals-of-statistics/volume-42/issue-6/Confidence-sets-for-persistence-diagrams/10.1214/14-AOS1252.full

## Summary

### Research objective

Propose the method to derive confidence sets for certain key quantities in persistent homology.

#### Assumption

Let $\mathbb{M}$ be a $d$-dimensional compact manifold with no boundary, embedded in $\mathbb{R}^D$ and $\mathrm{reacth}\left( \mathbb{M} \right) > 0$. Also, let $P$ be a probability measure with support $\mathbb{M}$, and let $X_1, \cdots, X_n$ be independent and identically distributed random variable drawn from $P$. At this time, let us define the following quantities:

$$
\begin{align*}
  \rho\left( x, t \right) = \dfrac{ P\left( B\left( x, t / 2 \right) \right) }{ t^d },\quad \rho_{X} \left( t \right) = \inf_{x\in\mathbb{M}} \rho\left( x, t \right)
\end{align*}
$$

where $B\left( x,r \right)$ is a open ball on $\mathbb{M}$ defined as follows:

$$
\begin{align*}
  B\left( x, r \right) = \Set{ y\in\mathbb{M} | \left\| x - y \right\| < r	}.
\end{align*}
$$

I assume that $\rho\left( x, t \right)$ is a continuous function of $t$, and I define

$$
\begin{align*}
  \rho\left( x, \downarrow 0 \right) = \lim_{t \to 0} \rho\left( x, t \right),\quad \rho_0 = \lim_{t \to t} \rho_X\left( t \right)
\end{align*}
$$

Also, I assume that for each $x \in \mathbb{M}$, $\rho\left( x, t \right)$ is a bounded continuous function of $t$, differentiable for $t \in \left( 0, t_0 \right)$ and right differentiable at zero. Moreover, partial derivative $\dfrac{\partial \rho}{\partial t} \left( x, t \right)$ exists and is bounded away from zero and infinity for $t$ in an open neighborhood of zero, and for some $t_0 > 0$ and some $C_1$ and $C_2$, I have

$$
\begin{align*}
  \sup_{x} \sup_{0\leq t\leq t_0} \left| \dfrac{\partial \rho}{\partial t} \left( x, t \right) \right| \leq C_1 < \infty,\quad \sup_{0\leq t \leq t_0} \left| \rho_X^\prime\left( t \right) \right| \leq C_2 < \infty
\end{align*}
$$

#### Confidence sets

Also, Let $\mathcal{S}_n = \Set{X_1, \cdots, X_n}$ be the set of $n$-size sample points obtained from $\mathbb{M}$ according to $P$, let $\mathcal{P}$ be the persistent diagram of $\mathbb{M}$, and let $\hat{\mathcal{P}}$ be the persistent diagram of $\mathcal{S}$. At this time, for a given $\alpha \in \left( 0, 1 \right)$ and a positive integer $n$, if there exists a real number $c_n\kakko{\mathcal{S}}$ such that

$$
\begin{align*}
  \limsup_{n\to\infty} \mathbb{P} \left[ W_{\infty} \left( \hat{\mathcal{P}}, \mathcal{P} \right) > c_n \right] \leq \alpha
\end{align*}
$$

then, it follows that $C_n = \left[ 0, c_n \right]$ is an asymptotic $1 - \alpha$ confidence set for the bottleneck distance $W_{\infty} \left( \hat{\mathcal{P}}, \mathcal{P} \right)$, that is,

$$
\begin{align*}
  \limsup_{n\to\infty} \mathbb{P} \left[ W_{\infty} \left( \hat{\mathcal{P}}, \mathcal{P} \right) \in \left[ 0, c_n \right] \right] \geq 1 - \alpha
\end{align*}
$$

Let $H$ be the Hausdorff distance, then the following holds.

$$
\begin{align*}
  W_{\infty} \left( \hat{\mathcal{P}}, \mathcal{P} \right) \leq H\left( \mathcal{S}_n, \mathbb{M} \right)
\end{align*}
$$

Hence, it suffices to find $c_n$ such that

$$
\begin{align*}
  \limsup_{n\to\infty} \mathbb{P} \left[ H\left( \mathcal{S}_n, \mathbb{M} \right) > c_n \right] \leq \alpha
\end{align*}
$$

The confidence set $\mathcal{C}_n$ is a subset of all persistence diagrams whose distance to $\mathcal{P}$ is at most $c_n$,

$$
\begin{align*}
  \mathcal{C}_n = \Set{ \tilde{\mathcal{P}} | W_{\infty} \left( \hat{\mathcal{P}}, \tilde{\mathcal{P}} \right) \leq c_n}
\end{align*}
$$

### Main result or conclusion

This paper proves the four methods to obtain a confidence set for persistent homology under appropriate conditions, such as subsampling, concentration of measure, method of shells, and density estimation

#### Method I: subsampling

For any positive integer $n$, let $b_n$ be such as

$$
\begin{align*}
  \lim_{n\to\infty} \dfrac{ b_n\log n }{ n } = 0,\quad \lim_{n\to\infty} b_n = \infty.
\end{align*}
$$

Also, let $\mathcal{S}_{b_n}^1, \cdots, \mathcal{S}_{b_n}^N$ be all $N$ subsamples, each of size $b$, from the data where $N = \binom{n}{b}$. At this time, let

$$
\begin{align*}
  T_j = H \left( \mathcal{S}_{b_n}^j, \mathcal{S}_n \right)
\end{align*}
$$

where $j = 1, \cdots, N$, define

$$
\begin{align*}
  L_{b_n} \left( t \right) \dfrac{ 1 }{ N } \sum_{j = 1}^N I\left( T_j > t \right)
\end{align*}
$$

where $I$ is an indicator function, and let $c_{b_n} = 2 L_{b_n}^{-1}\left( \alpha \right)$, then I can prove following theorem:

:::thm{.important}
Assume that $\rho_0 > 0$, then for all large $n$,

$$
\begin{align*}
  \mathbb{P} \left[ W_{\infty} \left( \hat{\mathcal{P}}, \mathcal{P} \right) > c_{b_n} \right] \leq \mathbb{P} \left[ H\left( \mathcal{S}_n, \mathbb{M} \right) > c_{b_n} \right] \leq \alpha + O\left( \dfrac{b}{n} \right)^{1 / 4}.
\end{align*}
$$

:::
